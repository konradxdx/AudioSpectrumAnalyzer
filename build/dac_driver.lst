ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"dac_driver.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Core/Src/dac_driver.c"
  20              		.section	.text.dac_write,"ax",%progbits
  21              		.align	1
  22              		.global	dac_write
  23              		.syntax unified
  24              		.thumb
  25              		.thumb_func
  27              	dac_write:
  28              	.LVL0:
  29              	.LFB216:
   1:Core/Src/dac_driver.c **** /*
   2:Core/Src/dac_driver.c ****  * dac_driver.c
   3:Core/Src/dac_driver.c ****  *
   4:Core/Src/dac_driver.c ****  *  Created on: 17 gru 2022
   5:Core/Src/dac_driver.c ****  *      Author: Konrad
   6:Core/Src/dac_driver.c ****  */
   7:Core/Src/dac_driver.c **** 
   8:Core/Src/dac_driver.c **** #include "dac_driver.h"
   9:Core/Src/dac_driver.c **** #include "spi.h"
  10:Core/Src/dac_driver.c **** 
  11:Core/Src/dac_driver.c **** 
  12:Core/Src/dac_driver.c **** uint8_t dac_write(uint8_t channel, uint8_t value, uint8_t dac){
  30              		.loc 1 12 63 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 8
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		.loc 1 12 63 is_stmt 0 view .LVU1
  35 0000 10B5     		push	{r4, lr}
  36              		.cfi_def_cfa_offset 8
  37              		.cfi_offset 4, -8
  38              		.cfi_offset 14, -4
  39 0002 82B0     		sub	sp, sp, #8
  40              		.cfi_def_cfa_offset 16
  13:Core/Src/dac_driver.c **** 
  14:Core/Src/dac_driver.c **** 
  15:Core/Src/dac_driver.c **** 	uint8_t toSend[3] = {0,0,0};
  41              		.loc 1 15 2 is_stmt 1 view .LVU2
  42              		.loc 1 15 10 is_stmt 0 view .LVU3
  43 0004 0023     		movs	r3, #0
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 2


  44 0006 ADF80430 		strh	r3, [sp, #4]	@ movhi
  45 000a 8DF80630 		strb	r3, [sp, #6]
  16:Core/Src/dac_driver.c **** 
  17:Core/Src/dac_driver.c **** 	if(channel<4){
  46              		.loc 1 17 2 is_stmt 1 view .LVU4
  47              		.loc 1 17 4 is_stmt 0 view .LVU5
  48 000e 0328     		cmp	r0, #3
  49 0010 55D8     		bhi	.L9
  50 0012 1446     		mov	r4, r2
  18:Core/Src/dac_driver.c **** 		toSend[0]=(channel<<3);
  51              		.loc 1 18 3 is_stmt 1 view .LVU6
  52              		.loc 1 18 21 is_stmt 0 view .LVU7
  53 0014 C000     		lsls	r0, r0, #3
  54              	.LVL1:
  55              		.loc 1 18 12 view .LVU8
  56 0016 8DF80400 		strb	r0, [sp, #4]
  19:Core/Src/dac_driver.c **** 	}else{
  20:Core/Src/dac_driver.c **** 		return 0;
  21:Core/Src/dac_driver.c **** 	}
  22:Core/Src/dac_driver.c **** 
  23:Core/Src/dac_driver.c **** 	toSend[2]=value;
  57              		.loc 1 23 2 is_stmt 1 view .LVU9
  58              		.loc 1 23 11 is_stmt 0 view .LVU10
  59 001a 8DF80610 		strb	r1, [sp, #6]
  24:Core/Src/dac_driver.c **** 
  25:Core/Src/dac_driver.c **** 	if(dac == 0)
  60              		.loc 1 25 2 is_stmt 1 view .LVU11
  61              		.loc 1 25 4 is_stmt 0 view .LVU12
  62 001e 2AB1     		cbz	r2, .L13
  26:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS0_GPIO_Port, CS0_Pin, GPIO_PIN_RESET);
  27:Core/Src/dac_driver.c **** 	else if(dac == 1)
  63              		.loc 1 27 7 is_stmt 1 view .LVU13
  64              		.loc 1 27 9 is_stmt 0 view .LVU14
  65 0020 012A     		cmp	r2, #1
  66 0022 15D0     		beq	.L14
  28:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, GPIO_PIN_RESET);
  29:Core/Src/dac_driver.c **** 	else if(dac == 2)
  67              		.loc 1 29 7 is_stmt 1 view .LVU15
  68              		.loc 1 29 9 is_stmt 0 view .LVU16
  69 0024 022A     		cmp	r2, #2
  70 0026 19D0     		beq	.L15
  30:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, GPIO_PIN_RESET);
  31:Core/Src/dac_driver.c **** 	else if(dac == 2)
  32:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS3_GPIO_Port, CS3_Pin, GPIO_PIN_RESET);
  33:Core/Src/dac_driver.c **** 	else
  34:Core/Src/dac_driver.c **** 		return 0;
  71              		.loc 1 34 10 view .LVU17
  72 0028 0020     		movs	r0, #0
  73 002a 49E0     		b	.L2
  74              	.L13:
  26:Core/Src/dac_driver.c **** 	else if(dac == 1)
  75              		.loc 1 26 3 is_stmt 1 view .LVU18
  76 002c 1A46     		mov	r2, r3
  77              	.LVL2:
  26:Core/Src/dac_driver.c **** 	else if(dac == 1)
  78              		.loc 1 26 3 is_stmt 0 view .LVU19
  79 002e 0421     		movs	r1, #4
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 3


  80              	.LVL3:
  26:Core/Src/dac_driver.c **** 	else if(dac == 1)
  81              		.loc 1 26 3 view .LVU20
  82 0030 2448     		ldr	r0, .L19
  83 0032 FFF7FEFF 		bl	HAL_GPIO_WritePin
  84              	.LVL4:
  85              	.L4:
  35:Core/Src/dac_driver.c **** 
  36:Core/Src/dac_driver.c **** 	HAL_SPI_Transmit(&hspi1, toSend, 3, 100);
  86              		.loc 1 36 2 is_stmt 1 view .LVU21
  87 0036 6423     		movs	r3, #100
  88 0038 0322     		movs	r2, #3
  89 003a 01A9     		add	r1, sp, #4
  90 003c 2248     		ldr	r0, .L19+4
  91 003e FFF7FEFF 		bl	HAL_SPI_Transmit
  92              	.LVL5:
  37:Core/Src/dac_driver.c **** 
  38:Core/Src/dac_driver.c **** 	if(dac == 0)
  93              		.loc 1 38 2 view .LVU22
  94              		.loc 1 38 4 is_stmt 0 view .LVU23
  95 0042 8CB1     		cbz	r4, .L16
  39:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS0_GPIO_Port, CS0_Pin, GPIO_PIN_SET);
  40:Core/Src/dac_driver.c **** 	else if(dac == 1)
  96              		.loc 1 40 7 is_stmt 1 view .LVU24
  97              		.loc 1 40 9 is_stmt 0 view .LVU25
  98 0044 012C     		cmp	r4, #1
  99 0046 2ED0     		beq	.L17
  41:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS1_GPIO_Port, CS1_Pin, GPIO_PIN_SET);
  42:Core/Src/dac_driver.c **** 	else if(dac == 2)
 100              		.loc 1 42 7 is_stmt 1 view .LVU26
 101              		.loc 1 42 9 is_stmt 0 view .LVU27
 102 0048 022C     		cmp	r4, #2
 103 004a 32D0     		beq	.L18
  43:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS2_GPIO_Port, CS2_Pin, GPIO_PIN_SET);
  44:Core/Src/dac_driver.c **** 	else if(dac == 2)
  45:Core/Src/dac_driver.c **** 		HAL_GPIO_WritePin(CS3_GPIO_Port, CS3_Pin, GPIO_PIN_SET);
  46:Core/Src/dac_driver.c **** 	else
  47:Core/Src/dac_driver.c **** 		return 0;
 104              		.loc 1 47 10 view .LVU28
 105 004c 0020     		movs	r0, #0
 106 004e 37E0     		b	.L2
 107              	.LVL6:
 108              	.L14:
  28:Core/Src/dac_driver.c **** 	else if(dac == 2)
 109              		.loc 1 28 3 is_stmt 1 view .LVU29
 110 0050 0022     		movs	r2, #0
 111              	.LVL7:
  28:Core/Src/dac_driver.c **** 	else if(dac == 2)
 112              		.loc 1 28 3 is_stmt 0 view .LVU30
 113 0052 1021     		movs	r1, #16
 114              	.LVL8:
  28:Core/Src/dac_driver.c **** 	else if(dac == 2)
 115              		.loc 1 28 3 view .LVU31
 116 0054 1D48     		ldr	r0, .L19+8
 117 0056 FFF7FEFF 		bl	HAL_GPIO_WritePin
 118              	.LVL9:
  28:Core/Src/dac_driver.c **** 	else if(dac == 2)
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 4


 119              		.loc 1 28 3 view .LVU32
 120 005a ECE7     		b	.L4
 121              	.LVL10:
 122              	.L15:
  30:Core/Src/dac_driver.c **** 	else if(dac == 2)
 123              		.loc 1 30 3 is_stmt 1 view .LVU33
 124 005c 0022     		movs	r2, #0
 125              	.LVL11:
  30:Core/Src/dac_driver.c **** 	else if(dac == 2)
 126              		.loc 1 30 3 is_stmt 0 view .LVU34
 127 005e 0821     		movs	r1, #8
 128              	.LVL12:
  30:Core/Src/dac_driver.c **** 	else if(dac == 2)
 129              		.loc 1 30 3 view .LVU35
 130 0060 1A48     		ldr	r0, .L19+8
 131 0062 FFF7FEFF 		bl	HAL_GPIO_WritePin
 132              	.LVL13:
  30:Core/Src/dac_driver.c **** 	else if(dac == 2)
 133              		.loc 1 30 3 view .LVU36
 134 0066 E6E7     		b	.L4
 135              	.L16:
  39:Core/Src/dac_driver.c **** 	else if(dac == 1)
 136              		.loc 1 39 3 is_stmt 1 view .LVU37
 137 0068 0122     		movs	r2, #1
 138 006a 0421     		movs	r1, #4
 139 006c 1548     		ldr	r0, .L19
 140 006e FFF7FEFF 		bl	HAL_GPIO_WritePin
 141              	.LVL14:
 142              	.L7:
  48:Core/Src/dac_driver.c **** 
  49:Core/Src/dac_driver.c **** 	HAL_GPIO_WritePin(LAT0_GPIO_Port, LAT0_Pin, GPIO_PIN_RESET);
 143              		.loc 1 49 2 view .LVU38
 144 0072 144C     		ldr	r4, .L19
 145              	.LVL15:
 146              		.loc 1 49 2 is_stmt 0 view .LVU39
 147 0074 0022     		movs	r2, #0
 148 0076 1021     		movs	r1, #16
 149 0078 2046     		mov	r0, r4
 150 007a FFF7FEFF 		bl	HAL_GPIO_WritePin
 151              	.LVL16:
  50:Core/Src/dac_driver.c **** 	HAL_GPIO_WritePin(LAT1_GPIO_Port, LAT1_Pin, GPIO_PIN_RESET);
 152              		.loc 1 50 2 is_stmt 1 view .LVU40
 153 007e 0022     		movs	r2, #0
 154 0080 2021     		movs	r1, #32
 155 0082 2046     		mov	r0, r4
 156 0084 FFF7FEFF 		bl	HAL_GPIO_WritePin
 157              	.LVL17:
  51:Core/Src/dac_driver.c **** 	HAL_Delay(1);
 158              		.loc 1 51 2 view .LVU41
 159 0088 0120     		movs	r0, #1
 160 008a FFF7FEFF 		bl	HAL_Delay
 161              	.LVL18:
  52:Core/Src/dac_driver.c **** 	HAL_GPIO_WritePin(LAT0_GPIO_Port, LAT0_Pin, GPIO_PIN_SET);
 162              		.loc 1 52 2 view .LVU42
 163 008e 0122     		movs	r2, #1
 164 0090 1021     		movs	r1, #16
 165 0092 2046     		mov	r0, r4
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 5


 166 0094 FFF7FEFF 		bl	HAL_GPIO_WritePin
 167              	.LVL19:
  53:Core/Src/dac_driver.c **** 	HAL_GPIO_WritePin(LAT1_GPIO_Port, LAT1_Pin, GPIO_PIN_SET);
 168              		.loc 1 53 2 view .LVU43
 169 0098 0122     		movs	r2, #1
 170 009a 2021     		movs	r1, #32
 171 009c 2046     		mov	r0, r4
 172 009e FFF7FEFF 		bl	HAL_GPIO_WritePin
 173              	.LVL20:
  54:Core/Src/dac_driver.c **** 
  55:Core/Src/dac_driver.c **** 	return 1;
 174              		.loc 1 55 2 view .LVU44
 175              		.loc 1 55 9 is_stmt 0 view .LVU45
 176 00a2 0120     		movs	r0, #1
 177 00a4 0CE0     		b	.L2
 178              	.L17:
  41:Core/Src/dac_driver.c **** 	else if(dac == 2)
 179              		.loc 1 41 3 is_stmt 1 view .LVU46
 180 00a6 0122     		movs	r2, #1
 181 00a8 1021     		movs	r1, #16
 182 00aa 0848     		ldr	r0, .L19+8
 183 00ac FFF7FEFF 		bl	HAL_GPIO_WritePin
 184              	.LVL21:
 185 00b0 DFE7     		b	.L7
 186              	.L18:
  43:Core/Src/dac_driver.c **** 	else if(dac == 2)
 187              		.loc 1 43 3 view .LVU47
 188 00b2 0122     		movs	r2, #1
 189 00b4 0821     		movs	r1, #8
 190 00b6 0548     		ldr	r0, .L19+8
 191 00b8 FFF7FEFF 		bl	HAL_GPIO_WritePin
 192              	.LVL22:
 193 00bc D9E7     		b	.L7
 194              	.LVL23:
 195              	.L9:
  20:Core/Src/dac_driver.c **** 	}
 196              		.loc 1 20 10 is_stmt 0 view .LVU48
 197 00be 0020     		movs	r0, #0
 198              	.LVL24:
 199              	.L2:
  56:Core/Src/dac_driver.c **** }
 200              		.loc 1 56 1 view .LVU49
 201 00c0 02B0     		add	sp, sp, #8
 202              		.cfi_def_cfa_offset 8
 203              		@ sp needed
 204 00c2 10BD     		pop	{r4, pc}
 205              	.L20:
 206              		.align	2
 207              	.L19:
 208 00c4 00040240 		.word	1073873920
 209 00c8 00000000 		.word	hspi1
 210 00cc 00000240 		.word	1073872896
 211              		.cfi_endproc
 212              	.LFE216:
 214              		.text
 215              	.Letext0:
 216              		.file 2 "C:/Users/Konrad/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-t
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 6


 217              		.file 3 "C:/Users/Konrad/AppData/Roaming/Code/User/globalStorage/bmd.stm32-for-vscode/@xpack-dev-t
 218              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f411xe.h"
 219              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 220              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 221              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 222              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_spi.h"
 223              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 224              		.file 10 "Core/Inc/spi.h"
ARM GAS  C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s 			page 7


DEFINED SYMBOLS
                            *ABS*:00000000 dac_driver.c
C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s:21     .text.dac_write:00000000 $t
C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s:27     .text.dac_write:00000000 dac_write
C:\Users\Konrad\AppData\Local\Temp\ccYPxIYe.s:208    .text.dac_write:000000c4 $d

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_Transmit
HAL_Delay
hspi1
